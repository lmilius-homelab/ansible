---

ansible_user: deployer
become: true
main_uid: "1100"
main_gid: "1100"

domain_name: "{{ vault_domain_name }}"
# local_domain: "util.{{ domain_name }}"

# ironicbadger.docker_compose_generator
appdata_path: "/home/lmilius/appdata"
ntp_timezone: "America/Chicago"
global_env_vars:
  - "PUID={{ main_uid }}"
  - "PGID={{ main_gid }}"
  - "TZ={{ ntp_timezone }}"
docker_compose_generator_uid: "{{ main_uid }}"
docker_compose_generator_gid: "{{ main_gid }}"
docker_compose_generator_output_path: /home/deployer/services


containers:
  ###
  - service_name: beszel_agent
    active: true
    image: henrygd/beszel-agent:0.12.7
    restart: unless-stopped
    network_mode: host
    volumes:
      - "{{ appdata_path }}/beszel/agent_data:/var/lib/beszel-agent"
      - "{{ appdata_path }}/beszel/socket:/beszel_socket"
      - "/var/run/docker.sock:/var/run/docker.sock:ro"
    include_global_env_vars: true
    environment:
      - "LISTEN=/beszel_socket/beszel.sock"
      - "HUB_URL=https://beszel.{{ domain_name }}"
      - "KEY={{ vault_beszel_agent_nvr_pubkey }}"
      - "TOKEN={{ vault_beszel_agent_nvr_token }}"
    
    